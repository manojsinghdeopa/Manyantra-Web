<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe</title>
<style>
    body {
        margin: 20px;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #f0f0f0;
    }
    #game-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
    }
    #board {
        display: grid;
        grid-template-columns: repeat(3, minmax(80px, 1fr));
        grid-template-rows: repeat(3, minmax(80px, 1fr));
        grid-gap: 10px;
    }
    .cell {
        width: 100%;
        height: 100%;
        background-color: #fff;
        border: 1px solid #ccc;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 2em;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .cell:hover {
        background-color: #f0f0f0;
    }
    .message {
        margin: 50px;
        text-align: center;
        margin-bottom: 25px;
        font-size: 1.2em;
    }
    .winning-cell {
        background-color: lightgreen !important;
    }
    .losing-cell {
        background-color: #ffcccc !important;
    }
    .play-again {
        cursor: pointer;
        color: blue;
        margin-top: 25px;
        text-decoration: underline;
    }
</style>
</head>
<body>
<div id="game-container">
    <div class="message" id="message">Click on a cell to start</div>
    <div id="board"></div>
    <div class="play-again" id="play-again" style="display: none;">Play Again</div>
</div>

<script>
    const board = document.getElementById('board');
    const message = document.getElementById('message');
    const playAgainBtn = document.getElementById('play-again');
    let currentPlayer = 'X';
    let gameBoard = ['', '', '', '', '', '', '', '', ''];

    function handleClick(index) {
        if (!gameBoard[index]) {
            gameBoard[index] = currentPlayer;
            render();
            if (checkWinner()) {
                message.textContent = `${currentPlayer} wins!`;
                playAgainBtn.style.display = 'block';
                disableClicks();
                return;
            }
            if (gameBoard.every(cell => cell !== '')) {
                message.textContent = 'It\'s a draw!';
                playAgainBtn.style.display = 'block';
                disableClicks();
                return;
            }
            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            message.textContent = currentPlayer === 'X' ? "It's your turn." : "It's Opponent's turn.";
            playAgainBtn.style.display = 'none';
            if (currentPlayer === 'O') {
                setTimeout(opponentMove, 1000); 
            }
        }
    }

    function checkWinner() {
        const winConditions = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ];

        return winConditions.some(condition => {
            const [a, b, c] = condition;
            return gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c];
        });
    }

    function render() {
        board.innerHTML = '';
        gameBoard.forEach((cell, index) => {
            const cellDiv = document.createElement('div');
            cellDiv.classList.add('cell');
            if (cell === 'X') {
                cellDiv.textContent = 'X';
            } else if (cell === 'O') {
                cellDiv.textContent = 'O';
            }
            cellDiv.addEventListener('click', () => handleClick(index));
            board.appendChild(cellDiv);
        });

        const winningIndexes = getWinningIndexes();
        if (winningIndexes.length > 0) {
            winningIndexes.forEach(index => {
                board.children[index].classList.add('winning-cell');
            });
        }
    }

    function disableClicks() {
        const cells = document.querySelectorAll('.cell');
        cells.forEach(cell => {
            cell.style.cursor = 'default';
            cell.removeEventListener('click', handleClick);
        });
    }

    function getWinningIndexes() {
        const winConditions = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ];

        for (const condition of winConditions) {
            const [a, b, c] = condition;
            if (gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c]) {
                return condition;
            }
        }
        return [];
    }

    function opponentMove() {
        let emptyCells = gameBoard.reduce((acc, val, index) => {
            if (val === '') acc.push(index);
            return acc;
        }, []);

        let randomIndex = Math.floor(Math.random() * emptyCells.length);
        let chosenCellIndex = emptyCells[randomIndex];

        gameBoard[chosenCellIndex] = currentPlayer;
        render();

        if (checkWinner()) {
            message.textContent = `${currentPlayer === 'X' ? 'Opponent' : 'You'} wins!`;
            playAgainBtn.style.display = 'block';
            disableClicks();
            return;
        }
        if (gameBoard.every(cell => cell !== '')) {
            message.textContent = 'It\'s a draw!';
            playAgainBtn.style.display = 'block';
            disableClicks();
            return;
        }

        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
        message.textContent = currentPlayer === 'X' ? "It's your turn." : "It's Opponent's turn.";
        playAgainBtn.style.display = 'none';
        if (currentPlayer === 'O') {
            setTimeout(opponentMove, 1000); 
        }
    }

    playAgainBtn.addEventListener('click', () => {
        resetGame();
    });

    function resetGame() {
        currentPlayer = 'X';
        gameBoard = ['', '', '', '', '', '', '', '', ''];
        message.textContent = "Click on a cell to start";
        playAgainBtn.style.display = 'none';
        render();
    }

    render();
</script>
</body>
</html>
